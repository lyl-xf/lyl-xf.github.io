(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{359:function(s,n,a){"use strict";a.r(n);var e=a(14),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"运行后端代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#运行后端代码"}},[s._v("#")]),s._v(" 运行后端代码")]),s._v(" "),n("h2",{attrs:{id:"下载代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#下载代码"}},[s._v("#")]),s._v(" 下载代码")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/lyl-xf/sana",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub - lyl-xf/sana"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("下载完成之后进入项目目录可以看到以下结构：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("|----sana               \n|----doc                #文档\n|----sana-abutment      #设备接入模块\n|----sana-base          #基础功能模块\n|----sana-devices       #设备管理模块\n|----sana-rules         #规则管理模块\n|----sana-service       #主服务模块\n|----sana-system        #系统管理模块\n|----sana-camera        #摄像头模块\n.....                   #待归化模块\n|----sana-web           #前端项目\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("ul",[n("li",[s._v("sana为整个项目的根目录，也是后端的根目录，直接使用后端编辑器打开sana项目即可。")]),s._v(" "),n("li",[s._v("其中sana-web为前端项目，需要单独独拷贝出去编译，并启动。")])]),s._v(" "),n("h2",{attrs:{id:"初始化数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化数据库"}},[s._v("#")]),s._v(" 初始化数据库：")]),s._v(" "),n("h3",{attrs:{id:"_1、初始化mysql数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、初始化mysql数据库"}},[s._v("#")]),s._v(" 1、初始化mysql数据库")]),s._v(" "),n("ul",[n("li",[s._v("连接到mysql数据库，创建数据库sana。")]),s._v(" "),n("li",[s._v("运行sql文件：doc/mysql/sana.sql")])]),s._v(" "),n("h3",{attrs:{id:"_2、初始化tdengine数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、初始化tdengine数据库"}},[s._v("#")]),s._v(" 2、初始化TDengine数据库")]),s._v(" "),n("p",[s._v("可以使用TDengineGUI，也可以通过命令行来操作，下面介绍的是命令行的方式：")]),s._v(" "),n("ul",[n("li",[s._v("命令行进入taos界面")])]),s._v(" "),n("p",[n("img",{attrs:{src:"/showImg/TdengineInit.png",alt:""}})]),s._v(" "),n("ul",[n("li",[n("p",[s._v("找到文件：doc/TDengine/TD.sql")])]),s._v(" "),n("li",[n("p",[s._v("使用建表语句（这里存储时长是3650天，可自行修改）：")])]),s._v(" "),n("li")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("CREATE DATABASE sana PRECISION 'ms' KEEP 3650 DURATION 10 BUFFER 16;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:"/showImg/TDCreatedDatabase.png",alt:""}})]),s._v(" "),n("ul",[n("li",[s._v("使用刚刚创建的sana数据库：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("use sana;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("创建日志超级表，建表语句如下：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("CREATE STABLE sys_log_operate (ts timestamp,\n    module NCHAR(200),\n    name NCHAR(100),\n    req_uri NCHAR(200),\n    req_method NCHAR(200),\n    req_params NCHAR(4000),\n    ip NCHAR(50),\n    user_agent NCHAR(300),\n    operate_type INT,\n    status INT,\n    real_name NCHAR(50)\n    ) TAGS (user_id BIGINT);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("ul",[n("li",[s._v("查看表是否存在")])]),s._v(" "),n("p",[n("img",{attrs:{src:"/showImg/TDTables.png",alt:""}})]),s._v(" "),n("h2",{attrs:{id:"配置后端环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置后端环境"}},[s._v("#")]),s._v(" 配置后端环境")]),s._v(" "),n("h3",{attrs:{id:"_1、使用编辑器打开sana项目-配置mavne"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、使用编辑器打开sana项目-配置mavne"}},[s._v("#")]),s._v(" 1、使用编辑器打开sana项目，配置mavne")]),s._v(" "),n("p",[n("img",{attrs:{src:"/showImg/runSetMaven.png",alt:""}})]),s._v(" "),n("p",[s._v("配置好之后，请使用maven编译项目，确保项目可以编译通过（先clena，后install）。\n"),n("img",{attrs:{src:"/showImg/mavenclean.png",alt:""}})]),s._v(" "),n("h3",{attrs:{id:"_2、修改本项目的sdk版本信息-确保和后端要求的sdk版本一致"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、修改本项目的sdk版本信息-确保和后端要求的sdk版本一致"}},[s._v("#")]),s._v(" 2、修改本项目的sdk版本信息，确保和后端要求的sdk版本一致")]),s._v(" "),n("p",[n("img",{attrs:{src:"/showImg/updateSdk.png",alt:""}})]),s._v(" "),n("h2",{attrs:{id:"修改配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[s._v("#")]),s._v(" 修改配置文件")]),s._v(" "),n("h3",{attrs:{id:"_1、修改application-yml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、修改application-yml"}},[s._v("#")]),s._v(" 1、修改application.yml")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("文件位置：\nsana-server/src/main/resources/application.yml")])]),s._v(" "),n("li",[n("p",[s._v("主要关注以下配置：")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# Tomcat\nserver:\n  port: 28081\n  servlet:\n    context-path: /sana\n    session:\n      cookie:\n        http-only: true\nspring:\n  # 环境 dev|test|prod\n  profiles:\n    active: dev\n  application:\n    name: sana\n  jackson:\n    time-zone: GMT+8\n  servlet:\n    multipart:\n      max-file-size: 400MB\n      max-request-size: 400MB\n  # 任务调度\n  quartz:\n    job-store-type: \"jdbc\"    # 任务存储类型\n    wait-for-jobs-to-complete-on-shutdown: false    # 关闭时等待任务完成\n    overwrite-existing-jobs: true   # 是否覆盖已有的任务\n    auto-startup: true    # 是否自动启动计划程序\n    startup-delay: 0s   # 延迟启动\n    jdbc:\n      initialize-schema: \"never\"  # 数据库架构初始化模式（never：从不进行初始化；always：每次都清空数据库进行初始化；embedded：只初始化内存数据库（默认值））\n    properties: # 相关属性配置\n      org:\n        quartz:\n          scheduler:\n            instanceName: SanaScheduler # 调度器实例名称\n            instanceId: AUTO  # 分布式节点ID自动生成\n          jobStore:\n            class: org.springframework.scheduling.quartz.LocalDataSourceJobStore\n            driverDelegateClass: org.quartz.impl.jdbcjobstore.StdJDBCDelegate\n            tablePrefix: QRTZ_  # 表前缀\n            isClustered: false  # 是否开启集群\n            dataSource: quartz  # 数据源别名（自定义）\n            clusterCheckinInterval: 10000 # 分布式节点有效性检查时间间隔（毫秒）\n            useProperties: false\n          # 线程池配置\n          threadPool:\n            class: org.quartz.simpl.SimpleThreadPool\n            threadCount: 10\n            threadPriority: 5\n            threadsInheritContextClassLoaderOfInitializingThread: true\nsana:\n  version: '@project.version@'\n  resetPassword: 'sana.password' #重置密码功能中默认要修改的密码\n  logging-enabled: true #是否开启日志存储（如果关闭，则不会进行日志数据的存储）\n  logging-save-type: mysql #日志存储类型（tdengine\\mysql）\n  devicedata-enabled: true  #是否开启设备数据存储\n  log-save-speed: 20  # 日志每次存储条数(建议根据实际配置、实际操作数量修改)\n  device-data-speed: 20  # 设备存储每次存储条数（建议根据实际配置、实际操作数量修改）\n  aviator-path:  #aviator规则脚本存储位置，如果不设置，则默认为当前程序运行的目录下的：/sana-rules/src/main/resources/script中\n  rule-priority: listening  #(timing\\listening)  #规则优先，定时：timing，监听：listening。这里要特别说明一下：如果设置为timing，则定时优先，如果是listening，则监听优先（这种情况发生在同一个设备同时属于定时、监听规则的情况下，并且在相同时间内触发，选择性的执行哪一个）\n  rule-action:  #rule配置\n    queue-type:  REDIS  # 队列类型(REDIS：已实现,KAFKA:暂无实现，或将放在后期)\n    core-size: 2        # 线程池大小\n    queue-capacity: 500 # 队列大小\n\nmybatis-plus:\n  mapper-locations: classpath*:/mapper/**/*.xml\n  typeAliasesPackage: com.sana.*.entity\n  global-config:\n    db-config:\n      id-type: AUTO\n      logic-delete-value: 1\n      logic-not-delete-value: 0\n    banner: false\n  configuration:\n    map-underscore-to-camel-case: true\n    cache-enabled: false\n    call-setters-on-nulls: true\n    jdbc-type-for-null: 'null'\n  configuration-properties:\n    prefix:\n    blobType: BLOB\n    boolValue: TRUE\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br")])]),n("h3",{attrs:{id:"_1、修改application-dev-yml-上面的配置中-active为-dev"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、修改application-dev-yml-上面的配置中-active为-dev"}},[s._v("#")]),s._v(" 1、修改application-dev.yml（上面的配置中，active为：dev）")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("文件位置：\nsana-server/src/main/resources/application-dev.yml")])]),s._v(" "),n("li",[n("p",[s._v("主要关注以下配置（将：文件存储minio配置、redis配置、数据库‘mysql’、‘TDengine’配置 更换为自己部署的信息。）：")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('############## Sa-Token 配置 (文档: https://sa-token.cc) ##############\nsa-token:\n  cookie:\n    secure: false\n    httpOnly: true\n  token-name: Authorization # token 名称（同时也是 cookie 名称）\n  timeout: 2592000  # token 有效期（单位：秒） 默认30天，-1 代表永久有效\n  active-timeout: -1  # token 最低活跃频率（单位：秒），如果 token 超过此时间没有访问系统就会被冻结，默认-1 代表不限制，永不冻结\n  is-concurrent: true  # 是否允许同一账号多地同时登录 （为 true 时允许一起登录, 为 false 时新登录挤掉旧登录）\n  is-share: false  # 在多人登录同一账号时，是否共用一个 token （为 true 时所有登录共用一个 token, 为 false 时每次登录新建一个 token）\n  token-style: uuid  # token 风格（默认可取值：uuid、simple-uuid、random-32、random-64、random-128、tik）\n  is-log: true  # 是否输出操作日志\n  jwt-secret-key: sanakeyidSDWsdjnusadFaaDWedwfdasefAS # jwt秘钥\n  ignore-config:\n    paths:\n      - /swagger/**\n      - /swagger-resources/**\n      - /swagger-ui.html\n      - /doc.html\n      - /swagger-ui/**\n      - /favicon.ico\n# 文件存储\nstorage:\n  minio:\n    access-key: Y2j5CZqWkTYjhRsadas\n    secret-key: ro2TfKWjV07uOTXBqp5PGzzRQNsadasXRY\n    end-point: http://127.0.0.1:9000\n    bucket-name: dev\n\nspring:\n  # 是否开启登录验证码\n  captchaEnabled: true\n  # 数据库连接信心\n  data:\n    redis:\n      database: 1\n      host: 127.0.0.1\n      port: 6379\n      password: 123456\n      timeout: 6000ms  # 连接超时时长（毫秒）\n      lettuce:\n        pool:\n          max-active: 20    # 最大活跃连接数\n          max-idle: 10      # 最大空闲连接\n          min-idle: 5       # 最小空闲连接\n          max-wait: 5000ms  # 获取连接最大等待时间\n          time-between-eviction-runs: 30000ms  # 空闲连接检查周期\n      stream:\n        core-pool-size: 3 #处理逻辑时线程池的核心线程数\n        max-pool-size: 3  #线程池最大线程数\n        queue-capacity: 500 # 队列容量，默认：500\n        batch-size: 40    #批量消费数量(一次最多获取多少条消息)\n        poll-timeout-seconds: 3 # Stream中没有消息时，等待时间\n        streams:          # 环境运行的时候，请一定要先创建好对应的stream；\n          - name: sana:stream:topic-ruleo  # 设备规则处理stream1\n            group: group-rule1\n          - name: sana:stream:topic-rulet  # 设备规则处理stream2\n            group: group-rule2\n          - name: sana:stream:topic-rulej  # 定时规则处理stream\n            group: group-rulejob\n  datasource:\n    dynamic:\n      hikari: # Hikari 连接池全局配置\n        connection-timeout: 30000     # 等待连接池分配链接的最大时长（毫秒），超过这个时长还没有可用的连接则发生 SQLException，默认：30 秒\n        minimum-idle: 2               # 最小空闲连接数\n        maximum-pool-size: 10         # 最大连接数\n        idle-timeout: 600000          # 连接超时的最大时长（毫秒），超时则被释放（retired），默认：10 分钟\n        max-lifetime: 1800000         # 连接的生命时长（毫秒），超时而且没被使用则被释放（retired），默认： 30 分钟\n        connection-test-query: SELECT 1\n      primary: mysql\n      datasource:\n        mysql:\n          # MySQL8\n          driver-class-name: com.mysql.cj.jdbc.Driver\n          url: jdbc:mysql://127.0.0.1:3306/sana?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai&nullCatalogMeansCurrent=true\n          username: root\n          password: 123456\n          # TDengine\n        tdengine:\n          #原生链接，需要配置客户端\n          #driver-class-name: com.taosdata.jdbc.TSDBDriver\n          #url: jdbc:TAOS://127.0.0.1:6041/sana?charset=UTF-8&locale=en_US.UTF-8&timezone=UTC-8\n          #REST 连接\n          driver-class-name: com.taosdata.jdbc.rs.RestfulDriver\n          url: jdbc:TAOS-RS://127.0.0.1:6041/sana?charset=UTF-8&locale=en_US.UTF-8&timezone=UTC-8\n          username: root\n          password: admin1234...\n# ZLMediaKit,目前计划整合GB28181、拉流两种方式，前端播放以webrtc为主。\nzlm:\n  enable: true # 是否启用，未启用不会加载\n  balance: round_robin # 节点负载均衡算法，默认round_robin\n  nodes: # zlm节点列表，每个节点配置如下\n    - server-id: zlm-node-1 # 节点ID，可自定义\n      host: "127.0.0.1" # 节点地址\n      secret: KqErX1KUSnoGn3IpHsdsdl8KyLSAdmVgLlpa # 节点密钥\n      enabled: true # 节点是否启用\n      hook-enabled: true # 节点是否启用hook接口，启用hook会注入hook接口，默认true，需要注意拦截器放通\n    - server-id: zlm-node-2 # 可配置多个节点\n      host: "127.0.0.1"\n      secret: KqErX1KUSnoGn3IpHl8KyLSAdmVgLlpa\n      enabled: false\n      hook-enabled: true\n# mqtt\nmqtt:\n  mqtt-message:                # 服务端配置\n    core-size:  2              #  线程池核心线程数\n    queue-capacity: 500        # 队列容量，默认：500\n  server:\n    enabled: true             # 是否开启服务端，默认：true\n    ip: 0.0.0.0                # 服务端 ip 默认为0.0.0.0,\n    port: 1884                 # 端口，默认：1883\n    name: Mqtt-broker(测试环境不开放端口)      # 名称，默认：Mica-Mqtt-Server\n    heartbeat-timeout: 120000   # 心跳超时，单位毫秒，默认: 1000 * 120\n    read-buffer-size: 8KB       # 接收数据的 buffer size，默认：8k\n    max-bytes-in-message: 10MB  # 消息解析最大 bytes 长度，默认：10M\n    auth:\n      enable: true              # 是否开启 mqtt 认证\n      username: root            # mqtt 认证用户名\n      password: MqttNB!%#...           # mqtt 认证密码\n    debug: false                # 如果开启 prometheus 指标收集建议关闭\n    stat-enable: false          # 开启指标收集，debug 和 prometheus 开启时需要打开，默认开启，关闭节省内存\n    proxy-protocol-enable: false   # 代理协议支持，nginx 可开启 tcp proxy_protocol on; 时转发源 ip 信息。2.4.1 版本开始支持\n    web-port: 8084             # http、websocket 端口，默认：8083\n    websocket-enable: true      # 是否开启 websocket，默认： true\n    http-enable: true           # 是否开启 http api，默认： false\n    http-basic-auth:\n      enable: true              # 是否开启 http basic auth，默认： false\n      username: root            # http basic auth 用户名\n      password: MqttNB!%#...    # http basic auth 密码\n    ssl:                        # mqtt tcp ssl 认证\n      enabled: false            # 是否开启 ssl 认证，2.1.0 开始支持双向认证\n      keystore-path:            # 必须参数：ssl keystore 目录，支持 classpath:/ 路径。\n      keystore-pass:            # 必选参数：ssl keystore 密码\n      truststore-path:          # 可选参数：ssl 双向认证 truststore 目录，支持 classpath:/ 路径。\n      truststore-pass:          # 可选参数：ssl 双向认证 truststore 密码\n      client-auth: none         # 是否需要客户端认证（双向认证），默认：NONE（不需要），REQUIRE（需要）\n    linkType: 0                 # 连接类型，暂无用处，后续预留\n  client:\n    enabled: true               # 是否开启客户端，默认：true\n    proxy-prefix : \'/SB/#\'          # 代理前缀（以‘SB’前缀为例，则默认订阅已经连接broker的：/SB/#）\n    proxy-status-prefix : /SBSTUTA    # 代理前缀（以‘SBSTUTA’前缀为例，则默认订阅已经连接broker的：/SBSTUTA，用于检测代理的设备连接状态。注意：如果使用的emqx，则需要配置一条上下线的规则，转发到该主题上来）\n    ip: 192.168.3.121               # 连接的服务端 ip（这里的ip为emqx，或者是其他第三方的mqtt-broker） ，默认：127.0.0.1\n    port: 1883                  # 端口：默认：1883\n    name: Mqtt-client(作为代理服务器的 代理监听客户端)      # 名称，默认：Mica-Mqtt-Client\n    client-id: lana-mqttClient           # 客户端Id（非常重要，一般为设备 sn，不可重复）\n    user-name: admin            # 认证的用户名\n    password: 123456     # 认证的密码\n    global-subscribe:           # 全局订阅的 topic，可被全局监听到，保留 session 停机重启，依然可以接受到消息。（2.2.9开始支持）\n    timeout: 5                  # 超时时间，单位：秒，默认：5秒\n    reconnect: true             # 是否重连，默认：true\n    re-interval: 5000           # 重连时间，默认 5000 毫秒\n    version: mqtt_3_1_1         # mqtt 协议版本，可选 MQTT_3_1、mqtt_3_1_1、mqtt_5，默认：mqtt_3_1_1\n    read-buffer-size: 8KB       # 接收数据的 buffer size，默认：8k\n    max-bytes-in-message: 10MB  # 消息解析最大 bytes 长度，默认：10M\n    keep-alive-secs: 60         # keep-alive 时间，单位：秒\n    heartbeat-mode: LAST_REQ    # 心跳模式，支持最后发送或接收心跳时间来计算心跳，默认：最后发送心跳的时间。（2.4.3 开始支持）\n    heartbeat-timeout-strategy: PING # 心跳超时策略，支持发送 PING 和 CLOSE 断开连接，默认：最大努力发送 PING。（2.4.3 开始支持）\n    clean-session: true         # mqtt clean session，默认：true\n    session-expiry-interval-secs: 0 # 开启保留 session 时，session 的有效期，默认：0（2.4.2 开始支持）\n    biz-thread-pool-size: 2     # mqtt 工作线程数，默认：2，如果消息量比较大，处理较慢，例如做 emqx 的转发消息处理，可以调大此参数（2.4.2 开始支持）\n    ssl:\n      enabled: false            # 是否开启 ssl 认证，2.1.0 开始支持双向认证\n      keystore-path:            # 可选参数：ssl 双向认证 keystore 目录，支持 classpath:/ 路径。\n      keystore-pass:            # 可选参数：ssl 双向认证 keystore 密码\n      truststore-path:          # 可选参数：ssl 双向认证 truststore 目录，支持 classpath:/ 路径。\n      truststore-pass:          # 可选参数：ssl 双向认证 truststore 密码\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br")])]),n("h2",{attrs:{id:"启动后端程序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动后端程序"}},[s._v("#")]),s._v(" 启动后端程序")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("找到SanaServerApplication启动文件（sana-server/src/main/java/com/sana/SanaServerApplication）")])]),s._v(" "),n("li",[n("p",[s._v("右键,选择： Run 'SanaServerAppl....mian()'，即可启动项目")])]),s._v(" "),n("li",[n("p",[s._v("启动效果：\n"),n("img",{attrs:{src:"/showImg/lanaStart.png",alt:""}})])])])])}),[],!1,null,null,null);n.default=t.exports}}]);