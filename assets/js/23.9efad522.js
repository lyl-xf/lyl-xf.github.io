(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{367:function(t,s,a){"use strict";a.r(s);var v=a(14),_=Object(v.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"模拟单个设备接入案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模拟单个设备接入案例"}},[t._v("#")]),t._v(" 模拟单个设备接入案例")]),t._v(" "),s("h2",{attrs:{id:"接入案例大致流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#接入案例大致流程"}},[t._v("#")]),t._v(" 接入案例大致流程")]),t._v(" "),s("ul",[s("li",[t._v("暂时使用mqtt客户端模拟设备")])]),t._v(" "),s("p",[t._v("① 新增产品，维护产品物模型\n② 新建设备，维护设备物模型、维护功能\n③ 新建设备分组，分组绑定设备\n④ 新建情景模式，配置情景模式开始节点信息、条件节点信息、动作节点信息、数据转发节点信息")]),t._v(" "),s("h2",{attrs:{id:"_1、新增产品"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、新增产品"}},[t._v("#")]),t._v(" 1、新增产品")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/addProduct.png",alt:""}})]),t._v(" "),s("p",[t._v("1、 新增产品")]),t._v(" "),s("p",[t._v("新增产品名称：这里以空气检测为例，我这里是创建的空气检测大类，大类下面创建了具体的产品")]),t._v(" "),s("p",[t._v("新建完设备之后，维护产品的物模型，下面以空气检测为例：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/addDeviceModel.png",alt:""}})]),t._v(" "),s("p",[t._v("其中有pm2.5、pm10、温度、湿度以及开关属性")]),t._v(" "),s("p",[t._v("2、设备产品的连接方式，我这里是选择的mqtt直连，默认的直接使用mqtt连接，客户端是：sb+设备id，对应的主题是：/SB+设备id；前缀信息可以进入到前缀配置中进行修改，我这里是为了省事以‘设备’的简称 来做的前缀。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/setLink.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"_2、新建设备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、新建设备"}},[t._v("#")]),t._v(" 2、新建设备")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/addDevice.png",alt:""}})]),t._v(" "),s("p",[t._v("1、新建设备的时候，选择对应的所属产品，我这里建立了一个‘粉色的空气检测器’，")]),t._v(" "),s("p",[t._v("它所属的是‘空气检测/室内空气检测器’ 产品，并且继承了这个产品的所有物模型，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/deviceMode.png",alt:""}})]),t._v(" "),s("p",[t._v("这里的物模型中，有来自产品的属性，以及自己定义的‘采集’属性。")]),t._v(" "),s("p",[t._v("2、配置设备的功能，我这里是创建了两个，开启、关闭，如有必要也加上采集功能，如图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/deviceServe.png",alt:""}})]),t._v(" "),s("p",[t._v("3、配置设备功能之后，会自动生成功能按钮，并且会自动生成功能对应的指令数据，点击会发送到对应的topic中，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/testDeviceServe.png",alt:""}})]),t._v(" "),s("p",[t._v("4、设备数据，设备数据分为两种，一种是实时数据，一种是历史数据，这里只展示实时数据，使用mqtt客户端（客户端是id为： sb+设备id，对应的主题是 ：/SB+设备id），然后将对应物模型的数据，以json的方式发送，页面会展示出来发送的实时数据，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/deviceData.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"_3、新建分组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、新建分组"}},[t._v("#")]),t._v(" 3、新建分组")]),t._v(" "),s("p",[t._v("这里就不展示了，很简单")]),t._v(" "),s("h2",{attrs:{id:"_4、新建情景模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、新建情景模式"}},[t._v("#")]),t._v(" 4、新建情景模式")]),t._v(" "),s("p",[t._v("1、新建情景模式，")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/addRule.png",alt:""}})]),t._v(" "),s("p",[t._v("2、新建完成之后，进入规则设置页面，维护‘开始’节点，‘开始节点’支持 定时触发 与 监听设备 两种方式。如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/timeStart.png",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/orTiaojian.png",alt:""}})]),t._v(" "),s("p",[t._v("3、设置好开始节点之后，开始维护‘条件’节点，这里要特别说明：如果‘开始’节点是监听某个设备，则当设备上报数据的时候就会直接触发规则；\n如果设置的是定时触发，则当定时时间到了的时候就会触发规则，条件中判断了几个设备，则会根据这些设备的‘采集’功能，通过mqtt发送对应的‘采集’功能的数据（条件中有多少，发多少，采集后，等设备上报新的数据之后，才会进行触发） 。")]),t._v(" "),s("p",[t._v("特别说明：当一个设备属于‘定时触发’和‘设备监听’规则的时候，配置文件中 rule-priority: listening，是可以设置为哪一种优先执行")]),t._v(" "),s("p",[t._v("4、设置好条件之后，维护‘动作’节点，这里每个条件下面，只能维护一个动作节点。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/addAction.png",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/doingAction.png",alt:""}})]),t._v(" "),s("p",[t._v("5、维护数据转发节点，这里可以设置多个数据转发节点，这个节点可以要，也可以不要，")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/addReturn.png",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/doingRetrun.png",alt:""}})]),t._v(" "),s("p",[t._v("6、测试这个规则的运行效果：这里依旧使用mqtt客户端进行模式设备")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/testRule.png",alt:""}})]),t._v(" "),s("p",[t._v("如果想看具体的执行情况，可以去对应的情景日志中查找：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/log.png",alt:""}})]),t._v(" "),s("p",[t._v("如果想看‘设备控制’节点的执行情况，可以订阅这个设备的topic（对应的主题是 ：/SB+设备id），就会收到对应的控制指令。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/single/testAction.png",alt:""}})])])}),[],!1,null,null,null);s.default=_.exports}}]);